<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines | Gustavo gugafer</title><meta name=keywords content="DevSecOps,Software Supply Chain,SBOM,CI/CD,Compliance"><meta name=description content="A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments."><meta name=author content="Gustavo de Oliveira Ferreira"><link rel=canonical href=https://gugafer.github.io/posts/sbom-enterprise-cicd/><meta name=google-site-verification content="G-Y08HKQ19T0"><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://gugafer.github.io/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://gugafer.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://gugafer.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://gugafer.github.io/apple-touch-icon.png><link rel=mask-icon href=https://gugafer.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://gugafer.github.io/posts/sbom-enterprise-cicd/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-Y08HKQ19T0"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Y08HKQ19T0")</script><meta property="og:url" content="https://gugafer.github.io/posts/sbom-enterprise-cicd/"><meta property="og:site_name" content="Gustavo gugafer"><meta property="og:title" content="Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines"><meta property="og:description" content="A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-15T10:00:00+00:00"><meta property="article:modified_time" content="2025-11-15T10:00:00+00:00"><meta property="article:tag" content="DevSecOps"><meta property="article:tag" content="Software Supply Chain"><meta property="article:tag" content="SBOM"><meta property="article:tag" content="CI/CD"><meta property="article:tag" content="Compliance"><meta name=twitter:card content="summary"><meta name=twitter:title content="Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines"><meta name=twitter:description content="A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://gugafer.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines","item":"https://gugafer.github.io/posts/sbom-enterprise-cicd/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines","name":"Implementing Software Bill of Materials (SBOM) in Enterprise CI\/CD Pipelines","description":"A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments.","keywords":["DevSecOps","Software Supply Chain","SBOM","CI/CD","Compliance"],"articleBody":" A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments, aligned with Executive Order 14028 requirements.\nIntroduction Executive Order 14028 (May 2021) mandates that federal agencies and their software suppliers implement software supply chain security measures, including:\nSoftware Bill of Materials (SBOM) generation Artifact signing and provenance verification Secure software development practices The urgency of these requirements was underscored by high-profile supply chain attacks:\nSolarWinds (2020): Compromised build system affected 18,000+ organizations including federal agencies Log4Shell (2021): CVE-2021-44228 exposed the challenge of identifying affected components across enterprise software portfolios Codecov (2021): CI/CD pipeline compromise demonstrated supply chain attack vectors This article provides a hands-on implementation guide based on real-world enterprise deployments in healthcare, financial services, and telecommunications sectors.\nWhat is an SBOM? An SBOM is a formal, machine-readable inventory of software components and dependencies. Think of it as a “nutritional label” for software — it lists every ingredient (library, framework, dependency) that goes into your application.\nKey SBOM Formats Format Standard Body Strengths SPDX Linux Foundation ISO/IEC 5962:2021 standard, comprehensive license tracking CycloneDX OWASP Security-focused, vulnerability correlation, lightweight SWID Tags ISO/IEC 19770-2 Enterprise asset management integration NTIA Minimum Elements Per NTIA guidance, an SBOM must include:\nSupplier Name — Entity that creates, defines, and identifies components Component Name — Designation assigned to a unit of software Version of the Component — Identifier used by supplier to specify a change Other Unique Identifiers — Other identifiers used to identify a component (PURL, CPE) Dependency Relationship — Characterizing the relationship (e.g., X includes Y) Author of SBOM Data — Entity that creates the SBOM data Timestamp — Record of the date and time of the SBOM data assembly Why SBOMs Matter for Critical Infrastructure The Log4Shell Case Study When CVE-2021-44228 (Log4Shell) was disclosed in December 2021, organizations faced a critical question: “Where in our software portfolio is Log4j used?”\nOrganizations with SBOMs could:\nQuery their SBOM database within minutes Identify affected applications, containers, and servers Prioritize patching based on exposure and criticality Organizations without SBOMs had to:\nManually scan thousands of applications Search through dependency trees of unknown depth Spend weeks identifying exposure Bottom line: SBOMs transform incident response from days/weeks to minutes/hours.\nFederal Mandate Timeline Date Milestone May 2021 EO 14028 signed November 2021 NIST defines “critical software” September 2022 OMB M-22-18 requires attestation from software producers 2023-2024 Federal agencies begin requiring SBOMs from vendors December 2024 CMMC 2.0 effective — supply chain security mandatory for DoD contractors Implementation Architecture Pipeline Overview ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │ BUILD │───▶│ SCAN │───▶│ SIGN │───▶│ PUBLISH │───▶│ DEPLOY │ │ │ │ │ │ │ │ │ │ │ │ Generate │ │ Vuln scan │ │ Cosign/ │ │ Store SBOM │ │ Verify │ │ SBOM (Syft) │ │ (Grype) │ │ Sigstore │ │ + artifact │ │ signatures │ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ Components Stage Tool Purpose Generate Syft Create SBOM from container images, filesystems Scan Grype Vulnerability scanning against SBOM Sign Cosign Keyless signing via Sigstore Store OCI Registry / Artifactory Artifact + SBOM storage with attestations Verify Cosign / Kyverno Admission-time signature verification Hands-On Implementation Step 1: SBOM Generation with Syft Install Syft # macOS/Linux curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin # Verify installation syft version Generate SBOM from Container Image # CycloneDX JSON format (recommended for security use cases) syft myregistry.azurecr.io/myapp:v1.2.3 -o cyclonedx-json \u003e sbom.json # SPDX format (for license compliance) syft myregistry.azurecr.io/myapp:v1.2.3 -o spdx-json \u003e sbom-spdx.json # View in human-readable table syft myregistry.azurecr.io/myapp:v1.2.3 -o table GitHub Actions Integration name: Build and Generate SBOM on: push: branches: [main] jobs: build: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Build Container Image run: docker build -t ${{ env.IMAGE_NAME }}:${{ github.sha }} . - name: Generate SBOM uses: anchore/sbom-action@v0 with: image: ${{ env.IMAGE_NAME }}:${{ github.sha }} format: cyclonedx-json output-file: sbom.cyclonedx.json - name: Upload SBOM as Artifact uses: actions/upload-artifact@v4 with: name: sbom path: sbom.cyclonedx.json Step 2: Vulnerability Scanning with Grype Install Grype curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin Scan SBOM for Vulnerabilities # Basic scan grype sbom:sbom.cyclonedx.json # Fail on high/critical vulnerabilities (for CI/CD gates) grype sbom:sbom.cyclonedx.json --fail-on high # Output as JSON for further processing grype sbom:sbom.cyclonedx.json -o json \u003e vulnerabilities.json CI/CD Gate Example - name: Scan SBOM for Vulnerabilities run: | grype sbom:sbom.cyclonedx.json --fail-on critical continue-on-error: false Step 3: Artifact Signing with Cosign Cosign enables cryptographic signing of container images and attestations, providing provenance verification.\nInstall Cosign # macOS brew install cosign # Linux curl -O -L https://github.com/sigstore/cosign/releases/latest/download/cosign-linux-amd64 chmod +x cosign-linux-amd64 mv cosign-linux-amd64 /usr/local/bin/cosign Keyless Signing (Recommended) Keyless signing uses Sigstore’s Fulcio CA and Rekor transparency log — no key management required.\n# Sign the container image (keyless via OIDC) cosign sign $IMAGE_NAME:$TAG # Attach SBOM to the image cosign attach sbom --sbom sbom.cyclonedx.json $IMAGE_NAME:$TAG # Create and sign an SBOM attestation cosign attest --predicate sbom.cyclonedx.json --type cyclonedx $IMAGE_NAME:$TAG Key-Based Signing (Air-Gapped Environments) # Generate key pair cosign generate-key-pair # Sign with private key cosign sign --key cosign.key $IMAGE_NAME:$TAG # Verify with public key cosign verify --key cosign.pub $IMAGE_NAME:$TAG Step 4: Complete Azure DevOps Pipeline trigger: branches: include: - main - release/* variables: imageName: 'myregistry.azurecr.io/myapp' tag: '$(Build.BuildId)' stages: - stage: Build displayName: 'Build and Scan' jobs: - job: BuildJob pool: vmImage: 'ubuntu-latest' steps: - task: Docker@2 displayName: 'Build Container Image' inputs: containerRegistry: 'AzureContainerRegistry' repository: 'myapp' command: 'build' Dockerfile: '**/Dockerfile' tags: '$(tag)' - script: | curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin syft $(imageName):$(tag) -o cyclonedx-json \u003e $(Build.ArtifactStagingDirectory)/sbom.json displayName: 'Generate SBOM' - script: | curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin grype sbom:$(Build.ArtifactStagingDirectory)/sbom.json --fail-on critical displayName: 'Vulnerability Scan' - script: | curl -O -L https://github.com/sigstore/cosign/releases/latest/download/cosign-linux-amd64 chmod +x cosign-linux-amd64 ./cosign-linux-amd64 sign --key $(COSIGN_PRIVATE_KEY) $(imageName):$(tag) ./cosign-linux-amd64 attest --key $(COSIGN_PRIVATE_KEY) --predicate $(Build.ArtifactStagingDirectory)/sbom.json --type cyclonedx $(imageName):$(tag) displayName: 'Sign Image and Attest SBOM' env: COSIGN_PRIVATE_KEY: $(CosignPrivateKey) COSIGN_PASSWORD: $(CosignPassword) - task: Docker@2 displayName: 'Push to Registry' inputs: containerRegistry: 'AzureContainerRegistry' repository: 'myapp' command: 'push' tags: '$(tag)' - publish: $(Build.ArtifactStagingDirectory)/sbom.json artifact: sbom displayName: 'Publish SBOM Artifact' Enterprise Considerations Policy Enforcement with Kyverno Enforce SBOM and signature requirements at Kubernetes admission time:\napiVersion: kyverno.io/v1 kind: ClusterPolicy metadata: name: require-image-signatures spec: validationFailureAction: Enforce background: false rules: - name: verify-signature match: any: - resources: kinds: - Pod verifyImages: - imageReferences: - \"myregistry.azurecr.io/*\" attestors: - count: 1 entries: - keys: publicKeys: |- -----BEGIN PUBLIC KEY----- MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE... -----END PUBLIC KEY----- Storage and Retention Requirement Implementation Centralized Storage Store SBOMs in artifact repository (JFrog Artifactory, AWS ECR, Azure ACR) alongside images Retention Period Regulated industries: 7+ years (HIPAA, PCI DSS); align with software lifecycle Searchability Index SBOMs in a database (DependencyTrack, GUAC) for CVE impact queries Access Control Restrict SBOM access to security/compliance teams; avoid exposing dependency details publicly Dependency-Track Integration Dependency-Track provides continuous SBOM analysis:\n# Upload SBOM to Dependency-Track via API curl -X POST \"https://dependencytrack.example.com/api/v1/bom\" \\ -H \"X-Api-Key: $DT_API_KEY\" \\ -H \"Content-Type: application/vnd.cyclonedx+json\" \\ -d @sbom.cyclonedx.json Alignment with Federal Standards Requirement EO 14028 Section Implementation SBOM for critical software Section 4(e) Syft + CycloneDX Provenance verification Section 4(e)(ix) Cosign + Sigstore/Rekor Vulnerability disclosure Section 4(d) Grype + OSV database Integrity verification Section 4(e)(iii) Image digests + attestations Secure development attestation Section 4(e)(i) SLSA framework adoption SLSA Framework Alignment SLSA (Supply-chain Levels for Software Artifacts) provides a maturity model:\nSLSA Level Requirements Tools Level 1 Documentation of build process Build scripts in version control Level 2 Tamper-resistant build service GitHub Actions, Azure Pipelines Level 3 Hardened build platform, provenance Sigstore, in-toto attestations Level 4 Hermetic, reproducible builds Bazel, Nix Conclusion Implementing SBOM in your CI/CD pipeline is no longer optional for organizations serving federal agencies or critical infrastructure sectors. The combination of:\nSyft for SBOM generation Grype for vulnerability scanning Cosign for signing and attestation …provides a foundation that can be adapted to your specific toolchain and compliance requirements.\nKey Takeaways Start Now: Federal requirements are already in effect; don’t wait for an RFP to demand SBOMs Automate Everything: SBOMs must be generated on every build, not manually Sign and Attest: Unsigned SBOMs have limited value; cryptographic provenance is essential Store and Index: SBOMs are only useful if you can query them during incidents Enforce at Admission: Use Kyverno/Gatekeeper to block unsigned images References Executive Order 14028 — Improving the Nation’s Cybersecurity NTIA SBOM Minimum Elements CISA SBOM Sharing Guidance Syft Documentation Grype Documentation Cosign Documentation SLSA Framework Dependency-Track NIST SP 800-218 — Secure Software Development Framework This article is part of a series on cloud security and DevSecOps best practices for regulated industries.\n","wordCount":"1410","inLanguage":"en","datePublished":"2025-11-15T10:00:00Z","dateModified":"2025-11-15T10:00:00Z","author":{"@type":"Person","name":"Gustavo de Oliveira Ferreira"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://gugafer.github.io/posts/sbom-enterprise-cicd/"},"publisher":{"@type":"Organization","name":"Gustavo gugafer","logo":{"@type":"ImageObject","url":"https://gugafer.github.io/images/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://gugafer.github.io/ accesskey=h title="Gustavo gugafer (Alt + H)">Gustavo gugafer</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://gugafer.github.io/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://gugafer.github.io/about/ title=About><span>About</span></a></li><li><a href=https://gugafer.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://gugafer.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://gugafer.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines</h1><div class=post-description>A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments.</div><div class=post-meta><span title='2025-11-15 10:00:00 +0000 UTC'>November 15, 2025</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Gustavo de Oliveira Ferreira</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a></li><li><a href=#what-is-an-sbom aria-label="What is an SBOM?">What is an SBOM?</a><ul><li><a href=#key-sbom-formats aria-label="Key SBOM Formats">Key SBOM Formats</a></li><li><a href=#ntia-minimum-elements aria-label="NTIA Minimum Elements">NTIA Minimum Elements</a></li></ul></li><li><a href=#why-sboms-matter-for-critical-infrastructure aria-label="Why SBOMs Matter for Critical Infrastructure">Why SBOMs Matter for Critical Infrastructure</a><ul><li><a href=#the-log4shell-case-study aria-label="The Log4Shell Case Study">The Log4Shell Case Study</a></li><li><a href=#federal-mandate-timeline aria-label="Federal Mandate Timeline">Federal Mandate Timeline</a></li></ul></li><li><a href=#implementation-architecture aria-label="Implementation Architecture">Implementation Architecture</a><ul><li><a href=#pipeline-overview aria-label="Pipeline Overview">Pipeline Overview</a></li><li><a href=#components aria-label=Components>Components</a></li></ul></li><li><a href=#hands-on-implementation aria-label="Hands-On Implementation">Hands-On Implementation</a><ul><li><a href=#step-1-sbom-generation-with-syft aria-label="Step 1: SBOM Generation with Syft">Step 1: SBOM Generation with Syft</a><ul><li><a href=#install-syft aria-label="Install Syft">Install Syft</a></li><li><a href=#generate-sbom-from-container-image aria-label="Generate SBOM from Container Image">Generate SBOM from Container Image</a></li><li><a href=#github-actions-integration aria-label="GitHub Actions Integration">GitHub Actions Integration</a></li></ul></li><li><a href=#step-2-vulnerability-scanning-with-grype aria-label="Step 2: Vulnerability Scanning with Grype">Step 2: Vulnerability Scanning with Grype</a><ul><li><a href=#install-grype aria-label="Install Grype">Install Grype</a></li><li><a href=#scan-sbom-for-vulnerabilities aria-label="Scan SBOM for Vulnerabilities">Scan SBOM for Vulnerabilities</a></li><li><a href=#cicd-gate-example aria-label="CI/CD Gate Example">CI/CD Gate Example</a></li></ul></li><li><a href=#step-3-artifact-signing-with-cosign aria-label="Step 3: Artifact Signing with Cosign">Step 3: Artifact Signing with Cosign</a><ul><li><a href=#install-cosign aria-label="Install Cosign">Install Cosign</a></li><li><a href=#keyless-signing-recommended aria-label="Keyless Signing (Recommended)">Keyless Signing (Recommended)</a></li><li><a href=#key-based-signing-air-gapped-environments aria-label="Key-Based Signing (Air-Gapped Environments)">Key-Based Signing (Air-Gapped Environments)</a></li></ul></li><li><a href=#step-4-complete-azure-devops-pipeline aria-label="Step 4: Complete Azure DevOps Pipeline">Step 4: Complete Azure DevOps Pipeline</a></li></ul></li><li><a href=#enterprise-considerations aria-label="Enterprise Considerations">Enterprise Considerations</a><ul><li><a href=#policy-enforcement-with-kyverno aria-label="Policy Enforcement with Kyverno">Policy Enforcement with Kyverno</a></li><li><a href=#storage-and-retention aria-label="Storage and Retention">Storage and Retention</a></li><li><a href=#dependency-track-integration aria-label="Dependency-Track Integration">Dependency-Track Integration</a></li></ul></li><li><a href=#alignment-with-federal-standards aria-label="Alignment with Federal Standards">Alignment with Federal Standards</a><ul><li><a href=#slsa-framework-alignment aria-label="SLSA Framework Alignment">SLSA Framework Alignment</a></li></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a><ul><li><a href=#key-takeaways aria-label="Key Takeaways">Key Takeaways</a></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><blockquote><p>A practical guide for implementing SBOM generation, artifact signing, and provenance tracking in enterprise environments, aligned with Executive Order 14028 requirements.</p></blockquote><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p><a href=https://www.govinfo.gov/content/pkg/FR-2021-05-17/pdf/2021-10460.pdf>Executive Order 14028</a> (May 2021) mandates that federal agencies and their software suppliers implement software supply chain security measures, including:</p><ul><li>Software Bill of Materials (SBOM) generation</li><li>Artifact signing and provenance verification</li><li>Secure software development practices</li></ul><p>The urgency of these requirements was underscored by high-profile supply chain attacks:</p><ul><li><strong>SolarWinds (2020):</strong> Compromised build system affected 18,000+ organizations including federal agencies</li><li><strong>Log4Shell (2021):</strong> CVE-2021-44228 exposed the challenge of identifying affected components across enterprise software portfolios</li><li><strong>Codecov (2021):</strong> CI/CD pipeline compromise demonstrated supply chain attack vectors</li></ul><p>This article provides a hands-on implementation guide based on real-world enterprise deployments in healthcare, financial services, and telecommunications sectors.</p><hr><h2 id=what-is-an-sbom>What is an SBOM?<a hidden class=anchor aria-hidden=true href=#what-is-an-sbom>#</a></h2><p>An SBOM is a formal, machine-readable inventory of software components and dependencies. Think of it as a &ldquo;nutritional label&rdquo; for software — it lists every ingredient (library, framework, dependency) that goes into your application.</p><h3 id=key-sbom-formats>Key SBOM Formats<a hidden class=anchor aria-hidden=true href=#key-sbom-formats>#</a></h3><table><thead><tr><th>Format</th><th>Standard Body</th><th>Strengths</th></tr></thead><tbody><tr><td><strong>SPDX</strong></td><td>Linux Foundation</td><td>ISO/IEC 5962:2021 standard, comprehensive license tracking</td></tr><tr><td><strong>CycloneDX</strong></td><td>OWASP</td><td>Security-focused, vulnerability correlation, lightweight</td></tr><tr><td><strong>SWID Tags</strong></td><td>ISO/IEC 19770-2</td><td>Enterprise asset management integration</td></tr></tbody></table><h3 id=ntia-minimum-elements>NTIA Minimum Elements<a hidden class=anchor aria-hidden=true href=#ntia-minimum-elements>#</a></h3><p>Per <a href=https://www.ntia.gov/sites/default/files/publications/sbom_minimum_elements_report_0.pdf>NTIA guidance</a>, an SBOM must include:</p><ol><li><strong>Supplier Name</strong> — Entity that creates, defines, and identifies components</li><li><strong>Component Name</strong> — Designation assigned to a unit of software</li><li><strong>Version of the Component</strong> — Identifier used by supplier to specify a change</li><li><strong>Other Unique Identifiers</strong> — Other identifiers used to identify a component (PURL, CPE)</li><li><strong>Dependency Relationship</strong> — Characterizing the relationship (e.g., X includes Y)</li><li><strong>Author of SBOM Data</strong> — Entity that creates the SBOM data</li><li><strong>Timestamp</strong> — Record of the date and time of the SBOM data assembly</li></ol><hr><h2 id=why-sboms-matter-for-critical-infrastructure>Why SBOMs Matter for Critical Infrastructure<a hidden class=anchor aria-hidden=true href=#why-sboms-matter-for-critical-infrastructure>#</a></h2><h3 id=the-log4shell-case-study>The Log4Shell Case Study<a hidden class=anchor aria-hidden=true href=#the-log4shell-case-study>#</a></h3><p>When CVE-2021-44228 (Log4Shell) was disclosed in December 2021, organizations faced a critical question: <em>&ldquo;Where in our software portfolio is Log4j used?&rdquo;</em></p><p>Organizations <strong>with</strong> SBOMs could:</p><ul><li>Query their SBOM database within minutes</li><li>Identify affected applications, containers, and servers</li><li>Prioritize patching based on exposure and criticality</li></ul><p>Organizations <strong>without</strong> SBOMs had to:</p><ul><li>Manually scan thousands of applications</li><li>Search through dependency trees of unknown depth</li><li>Spend weeks identifying exposure</li></ul><p><strong>Bottom line:</strong> SBOMs transform incident response from days/weeks to minutes/hours.</p><h3 id=federal-mandate-timeline>Federal Mandate Timeline<a hidden class=anchor aria-hidden=true href=#federal-mandate-timeline>#</a></h3><table><thead><tr><th>Date</th><th>Milestone</th></tr></thead><tbody><tr><td>May 2021</td><td>EO 14028 signed</td></tr><tr><td>November 2021</td><td>NIST defines &ldquo;critical software&rdquo;</td></tr><tr><td>September 2022</td><td>OMB M-22-18 requires attestation from software producers</td></tr><tr><td>2023-2024</td><td>Federal agencies begin requiring SBOMs from vendors</td></tr><tr><td>December 2024</td><td>CMMC 2.0 effective — supply chain security mandatory for DoD contractors</td></tr></tbody></table><hr><h2 id=implementation-architecture>Implementation Architecture<a hidden class=anchor aria-hidden=true href=#implementation-architecture>#</a></h2><h3 id=pipeline-overview>Pipeline Overview<a hidden class=anchor aria-hidden=true href=#pipeline-overview>#</a></h3><pre tabindex=0><code>┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   BUILD     │───▶│    SCAN     │───▶│    SIGN     │───▶│   PUBLISH   │───▶│   DEPLOY    │
│             │    │             │    │             │    │             │    │             │
│ Generate    │    │ Vuln scan   │    │ Cosign/     │    │ Store SBOM  │    │ Verify      │
│ SBOM (Syft) │    │ (Grype)     │    │ Sigstore    │    │ + artifact  │    │ signatures  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
</code></pre><h3 id=components>Components<a hidden class=anchor aria-hidden=true href=#components>#</a></h3><table><thead><tr><th>Stage</th><th>Tool</th><th>Purpose</th></tr></thead><tbody><tr><td>Generate</td><td><a href=https://github.com/anchore/syft>Syft</a></td><td>Create SBOM from container images, filesystems</td></tr><tr><td>Scan</td><td><a href=https://github.com/anchore/grype>Grype</a></td><td>Vulnerability scanning against SBOM</td></tr><tr><td>Sign</td><td><a href=https://github.com/sigstore/cosign>Cosign</a></td><td>Keyless signing via Sigstore</td></tr><tr><td>Store</td><td>OCI Registry / Artifactory</td><td>Artifact + SBOM storage with attestations</td></tr><tr><td>Verify</td><td>Cosign / Kyverno</td><td>Admission-time signature verification</td></tr></tbody></table><hr><h2 id=hands-on-implementation>Hands-On Implementation<a hidden class=anchor aria-hidden=true href=#hands-on-implementation>#</a></h2><h3 id=step-1-sbom-generation-with-syft>Step 1: SBOM Generation with Syft<a hidden class=anchor aria-hidden=true href=#step-1-sbom-generation-with-syft>#</a></h3><h4 id=install-syft>Install Syft<a hidden class=anchor aria-hidden=true href=#install-syft>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># macOS/Linux</span>
</span></span><span style=display:flex><span>curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Verify installation</span>
</span></span><span style=display:flex><span>syft version
</span></span></code></pre></div><h4 id=generate-sbom-from-container-image>Generate SBOM from Container Image<a hidden class=anchor aria-hidden=true href=#generate-sbom-from-container-image>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># CycloneDX JSON format (recommended for security use cases)</span>
</span></span><span style=display:flex><span>syft myregistry.azurecr.io/myapp:v1.2.3 -o cyclonedx-json &gt; sbom.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># SPDX format (for license compliance)</span>
</span></span><span style=display:flex><span>syft myregistry.azurecr.io/myapp:v1.2.3 -o spdx-json &gt; sbom-spdx.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># View in human-readable table</span>
</span></span><span style=display:flex><span>syft myregistry.azurecr.io/myapp:v1.2.3 -o table
</span></span></code></pre></div><h4 id=github-actions-integration>GitHub Actions Integration<a hidden class=anchor aria-hidden=true href=#github-actions-integration>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build and Generate SBOM</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>: [<span style=color:#ae81ff>main]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build Container Image</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>run</span>: <span style=color:#ae81ff>docker build -t ${{ env.IMAGE_NAME }}:${{ github.sha }} .</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Generate SBOM</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>anchore/sbom-action@v0</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>: <span style=color:#ae81ff>${{ env.IMAGE_NAME }}:${{ github.sha }}</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>format</span>: <span style=color:#ae81ff>cyclonedx-json</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>output-file</span>: <span style=color:#ae81ff>sbom.cyclonedx.json</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Upload SBOM as Artifact</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/upload-artifact@v4</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>name</span>: <span style=color:#ae81ff>sbom</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>path</span>: <span style=color:#ae81ff>sbom.cyclonedx.json</span>
</span></span></code></pre></div><h3 id=step-2-vulnerability-scanning-with-grype>Step 2: Vulnerability Scanning with Grype<a hidden class=anchor aria-hidden=true href=#step-2-vulnerability-scanning-with-grype>#</a></h3><h4 id=install-grype>Install Grype<a hidden class=anchor aria-hidden=true href=#install-grype>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin
</span></span></code></pre></div><h4 id=scan-sbom-for-vulnerabilities>Scan SBOM for Vulnerabilities<a hidden class=anchor aria-hidden=true href=#scan-sbom-for-vulnerabilities>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Basic scan</span>
</span></span><span style=display:flex><span>grype sbom:sbom.cyclonedx.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Fail on high/critical vulnerabilities (for CI/CD gates)</span>
</span></span><span style=display:flex><span>grype sbom:sbom.cyclonedx.json --fail-on high
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Output as JSON for further processing</span>
</span></span><span style=display:flex><span>grype sbom:sbom.cyclonedx.json -o json &gt; vulnerabilities.json
</span></span></code></pre></div><h4 id=cicd-gate-example>CI/CD Gate Example<a hidden class=anchor aria-hidden=true href=#cicd-gate-example>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Scan SBOM for Vulnerabilities</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    grype sbom:sbom.cyclonedx.json --fail-on critical</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>continue-on-error</span>: <span style=color:#66d9ef>false</span>
</span></span></code></pre></div><h3 id=step-3-artifact-signing-with-cosign>Step 3: Artifact Signing with Cosign<a hidden class=anchor aria-hidden=true href=#step-3-artifact-signing-with-cosign>#</a></h3><p>Cosign enables cryptographic signing of container images and attestations, providing provenance verification.</p><h4 id=install-cosign>Install Cosign<a hidden class=anchor aria-hidden=true href=#install-cosign>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># macOS</span>
</span></span><span style=display:flex><span>brew install cosign
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Linux</span>
</span></span><span style=display:flex><span>curl -O -L https://github.com/sigstore/cosign/releases/latest/download/cosign-linux-amd64
</span></span><span style=display:flex><span>chmod +x cosign-linux-amd64
</span></span><span style=display:flex><span>mv cosign-linux-amd64 /usr/local/bin/cosign
</span></span></code></pre></div><h4 id=keyless-signing-recommended>Keyless Signing (Recommended)<a hidden class=anchor aria-hidden=true href=#keyless-signing-recommended>#</a></h4><p>Keyless signing uses Sigstore&rsquo;s Fulcio CA and Rekor transparency log — no key management required.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Sign the container image (keyless via OIDC)</span>
</span></span><span style=display:flex><span>cosign sign $IMAGE_NAME:$TAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Attach SBOM to the image</span>
</span></span><span style=display:flex><span>cosign attach sbom --sbom sbom.cyclonedx.json $IMAGE_NAME:$TAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create and sign an SBOM attestation</span>
</span></span><span style=display:flex><span>cosign attest --predicate sbom.cyclonedx.json --type cyclonedx $IMAGE_NAME:$TAG
</span></span></code></pre></div><h4 id=key-based-signing-air-gapped-environments>Key-Based Signing (Air-Gapped Environments)<a hidden class=anchor aria-hidden=true href=#key-based-signing-air-gapped-environments>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Generate key pair</span>
</span></span><span style=display:flex><span>cosign generate-key-pair
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Sign with private key</span>
</span></span><span style=display:flex><span>cosign sign --key cosign.key $IMAGE_NAME:$TAG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Verify with public key</span>
</span></span><span style=display:flex><span>cosign verify --key cosign.pub $IMAGE_NAME:$TAG
</span></span></code></pre></div><h3 id=step-4-complete-azure-devops-pipeline>Step 4: Complete Azure DevOps Pipeline<a hidden class=anchor aria-hidden=true href=#step-4-complete-azure-devops-pipeline>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>trigger</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>include</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>main</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>release/*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>variables</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>imageName</span>: <span style=color:#e6db74>&#39;myregistry.azurecr.io/myapp&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>tag</span>: <span style=color:#e6db74>&#39;$(Build.BuildId)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>stages</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>stage</span>: <span style=color:#ae81ff>Build</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Build and Scan&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>job</span>: <span style=color:#ae81ff>BuildJob</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>pool</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>vmImage</span>: <span style=color:#e6db74>&#39;ubuntu-latest&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>task</span>: <span style=color:#ae81ff>Docker@2</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Build Container Image&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containerRegistry</span>: <span style=color:#e6db74>&#39;AzureContainerRegistry&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>repository</span>: <span style=color:#e6db74>&#39;myapp&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>command</span>: <span style=color:#e6db74>&#39;build&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>Dockerfile</span>: <span style=color:#e6db74>&#39;**/Dockerfile&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>tags</span>: <span style=color:#e6db74>&#39;$(tag)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              syft $(imageName):$(tag) -o cyclonedx-json &gt; $(Build.ArtifactStagingDirectory)/sbom.json</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Generate SBOM&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              grype sbom:$(Build.ArtifactStagingDirectory)/sbom.json --fail-on critical</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Vulnerability Scan&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              curl -O -L https://github.com/sigstore/cosign/releases/latest/download/cosign-linux-amd64
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              chmod +x cosign-linux-amd64
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              ./cosign-linux-amd64 sign --key $(COSIGN_PRIVATE_KEY) $(imageName):$(tag)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              ./cosign-linux-amd64 attest --key $(COSIGN_PRIVATE_KEY) --predicate $(Build.ArtifactStagingDirectory)/sbom.json --type cyclonedx $(imageName):$(tag)</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Sign Image and Attest SBOM&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>COSIGN_PRIVATE_KEY</span>: <span style=color:#ae81ff>$(CosignPrivateKey)</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>COSIGN_PASSWORD</span>: <span style=color:#ae81ff>$(CosignPassword)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>task</span>: <span style=color:#ae81ff>Docker@2</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Push to Registry&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containerRegistry</span>: <span style=color:#e6db74>&#39;AzureContainerRegistry&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>repository</span>: <span style=color:#e6db74>&#39;myapp&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>command</span>: <span style=color:#e6db74>&#39;push&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>tags</span>: <span style=color:#e6db74>&#39;$(tag)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>publish</span>: <span style=color:#ae81ff>$(Build.ArtifactStagingDirectory)/sbom.json</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>artifact</span>: <span style=color:#ae81ff>sbom</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Publish SBOM Artifact&#39;</span>
</span></span></code></pre></div><hr><h2 id=enterprise-considerations>Enterprise Considerations<a hidden class=anchor aria-hidden=true href=#enterprise-considerations>#</a></h2><h3 id=policy-enforcement-with-kyverno>Policy Enforcement with Kyverno<a hidden class=anchor aria-hidden=true href=#policy-enforcement-with-kyverno>#</a></h3><p>Enforce SBOM and signature requirements at Kubernetes admission time:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>kyverno.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterPolicy</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>require-image-signatures</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>validationFailureAction</span>: <span style=color:#ae81ff>Enforce</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>background</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>verify-signature</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>match</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>any</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>resources</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>kinds</span>:
</span></span><span style=display:flex><span>                - <span style=color:#ae81ff>Pod</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>verifyImages</span>:
</span></span><span style=display:flex><span>        - <span style=color:#f92672>imageReferences</span>:
</span></span><span style=display:flex><span>            - <span style=color:#e6db74>&#34;myregistry.azurecr.io/*&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>attestors</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>count</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>entries</span>:
</span></span><span style=display:flex><span>                - <span style=color:#f92672>keys</span>:
</span></span><span style=display:flex><span>                    <span style=color:#f92672>publicKeys</span>: |-<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                      -----BEGIN PUBLIC KEY-----
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                      MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE...
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                      -----END PUBLIC KEY-----</span>
</span></span></code></pre></div><h3 id=storage-and-retention>Storage and Retention<a hidden class=anchor aria-hidden=true href=#storage-and-retention>#</a></h3><table><thead><tr><th>Requirement</th><th>Implementation</th></tr></thead><tbody><tr><td><strong>Centralized Storage</strong></td><td>Store SBOMs in artifact repository (JFrog Artifactory, AWS ECR, Azure ACR) alongside images</td></tr><tr><td><strong>Retention Period</strong></td><td>Regulated industries: 7+ years (HIPAA, PCI DSS); align with software lifecycle</td></tr><tr><td><strong>Searchability</strong></td><td>Index SBOMs in a database (DependencyTrack, GUAC) for CVE impact queries</td></tr><tr><td><strong>Access Control</strong></td><td>Restrict SBOM access to security/compliance teams; avoid exposing dependency details publicly</td></tr></tbody></table><h3 id=dependency-track-integration>Dependency-Track Integration<a hidden class=anchor aria-hidden=true href=#dependency-track-integration>#</a></h3><p><a href=https://dependencytrack.org/>Dependency-Track</a> provides continuous SBOM analysis:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Upload SBOM to Dependency-Track via API</span>
</span></span><span style=display:flex><span>curl -X POST <span style=color:#e6db74>&#34;https://dependencytrack.example.com/api/v1/bom&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -H <span style=color:#e6db74>&#34;X-Api-Key: </span>$DT_API_KEY<span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -H <span style=color:#e6db74>&#34;Content-Type: application/vnd.cyclonedx+json&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -d @sbom.cyclonedx.json
</span></span></code></pre></div><hr><h2 id=alignment-with-federal-standards>Alignment with Federal Standards<a hidden class=anchor aria-hidden=true href=#alignment-with-federal-standards>#</a></h2><table><thead><tr><th>Requirement</th><th>EO 14028 Section</th><th>Implementation</th></tr></thead><tbody><tr><td>SBOM for critical software</td><td>Section 4(e)</td><td>Syft + CycloneDX</td></tr><tr><td>Provenance verification</td><td>Section 4(e)(ix)</td><td>Cosign + Sigstore/Rekor</td></tr><tr><td>Vulnerability disclosure</td><td>Section 4(d)</td><td>Grype + OSV database</td></tr><tr><td>Integrity verification</td><td>Section 4(e)(iii)</td><td>Image digests + attestations</td></tr><tr><td>Secure development attestation</td><td>Section 4(e)(i)</td><td>SLSA framework adoption</td></tr></tbody></table><h3 id=slsa-framework-alignment>SLSA Framework Alignment<a hidden class=anchor aria-hidden=true href=#slsa-framework-alignment>#</a></h3><p><a href=https://slsa.dev/>SLSA</a> (Supply-chain Levels for Software Artifacts) provides a maturity model:</p><table><thead><tr><th>SLSA Level</th><th>Requirements</th><th>Tools</th></tr></thead><tbody><tr><td>Level 1</td><td>Documentation of build process</td><td>Build scripts in version control</td></tr><tr><td>Level 2</td><td>Tamper-resistant build service</td><td>GitHub Actions, Azure Pipelines</td></tr><tr><td>Level 3</td><td>Hardened build platform, provenance</td><td>Sigstore, in-toto attestations</td></tr><tr><td>Level 4</td><td>Hermetic, reproducible builds</td><td>Bazel, Nix</td></tr></tbody></table><hr><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Implementing SBOM in your CI/CD pipeline is no longer optional for organizations serving federal agencies or critical infrastructure sectors. The combination of:</p><ul><li><strong>Syft</strong> for SBOM generation</li><li><strong>Grype</strong> for vulnerability scanning</li><li><strong>Cosign</strong> for signing and attestation</li></ul><p>&mldr;provides a foundation that can be adapted to your specific toolchain and compliance requirements.</p><h3 id=key-takeaways>Key Takeaways<a hidden class=anchor aria-hidden=true href=#key-takeaways>#</a></h3><ol><li><strong>Start Now:</strong> Federal requirements are already in effect; don&rsquo;t wait for an RFP to demand SBOMs</li><li><strong>Automate Everything:</strong> SBOMs must be generated on every build, not manually</li><li><strong>Sign and Attest:</strong> Unsigned SBOMs have limited value; cryptographic provenance is essential</li><li><strong>Store and Index:</strong> SBOMs are only useful if you can query them during incidents</li><li><strong>Enforce at Admission:</strong> Use Kyverno/Gatekeeper to block unsigned images</li></ol><hr><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://www.govinfo.gov/content/pkg/FR-2021-05-17/pdf/2021-10460.pdf>Executive Order 14028 — Improving the Nation&rsquo;s Cybersecurity</a></li><li><a href=https://www.ntia.gov/sites/default/files/publications/sbom_minimum_elements_report_0.pdf>NTIA SBOM Minimum Elements</a></li><li><a href=https://www.cisa.gov/sbom>CISA SBOM Sharing Guidance</a></li><li><a href=https://github.com/anchore/syft>Syft Documentation</a></li><li><a href=https://github.com/anchore/grype>Grype Documentation</a></li><li><a href=https://github.com/sigstore/cosign>Cosign Documentation</a></li><li><a href=https://slsa.dev/>SLSA Framework</a></li><li><a href=https://dependencytrack.org/>Dependency-Track</a></li><li><a href=https://csrc.nist.gov/publications/detail/sp/800-218/final>NIST SP 800-218 — Secure Software Development Framework</a></li></ul><hr><p><em>This article is part of a series on cloud security and DevSecOps best practices for regulated industries.</em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://gugafer.github.io/tags/devsecops/>DevSecOps</a></li><li><a href=https://gugafer.github.io/tags/software-supply-chain/>Software Supply Chain</a></li><li><a href=https://gugafer.github.io/tags/sbom/>SBOM</a></li><li><a href=https://gugafer.github.io/tags/ci/cd/>CI/CD</a></li><li><a href=https://gugafer.github.io/tags/compliance/>Compliance</a></li></ul><nav class=paginav><a class=prev href=https://gugafer.github.io/posts/welcome-to-my-tech-blog/><span class=title>« Prev</span><br><span>Building Cloud-Native Futures: A Journey into DevSecOps & Architecture</span>
</a><a class=next href=https://gugafer.github.io/posts/azure-landing-zone-healthcare/><span class=title>Next »</span><br><span>Azure Landing Zone Architecture for Healthcare: HIPAA-Compliant Cloud Foundations</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on x" href="https://x.com/intent/tweet/?text=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines&amp;url=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f&amp;hashtags=DevSecOps%2cSoftwareSupplyChain%2cSBOM%2cCI%2fCD%2cCompliance"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f&amp;title=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines&amp;summary=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines&amp;source=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f&title=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on whatsapp" href="https://api.whatsapp.com/send?text=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines%20-%20https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on telegram" href="https://telegram.me/share/url?text=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines&amp;url=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Implementing Software Bill of Materials (SBOM) in Enterprise CI/CD Pipelines on ycombinator" href="https://news.ycombinator.com/submitlink?t=Implementing%20Software%20Bill%20of%20Materials%20%28SBOM%29%20in%20Enterprise%20CI%2fCD%20Pipelines&u=https%3a%2f%2fgugafer.github.io%2fposts%2fsbom-enterprise-cicd%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://gugafer.github.io/>Gustavo gugafer</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>